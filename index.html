<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™å­¸è¨­è¨ˆè¼”åŠ©å·¥å…·æè©å™¨ Teaching Design Aids Prompt Builder (TDA Prompt Builder)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Orbitron:wght@400;500;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #020617; /* Slate 950 */
            color: #e2e8f0; /* Slate 200 */
            overflow-x: hidden;
        }

        /* Cyber Grid Background */
        .cyber-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 200vw;
            height: 200vh;
            background-image: 
                linear-gradient(rgba(6, 182, 212, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
            animation: grid-move 20s linear infinite;
            z-index: -1;
            pointer-events: none;
        }

        @keyframes grid-move {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(40px) translateZ(-200px); }
        }

        /* Vignette Effect */
        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 50%, #020617 100%);
            z-index: -1;
            pointer-events: none;
        }

        /* Scrollbar */
        textarea::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track {
            background: #0f172a; 
            border-radius: 4px;
        }
        textarea::-webkit-scrollbar-thumb {
            background: #334155; 
            border-radius: 4px;
            border: 1px solid #06b6d4;
        }
        textarea::-webkit-scrollbar-thumb:hover {
            background: #06b6d4; 
        }

        /* Holographic Gradient Animation */
        @keyframes gradient-xy {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .animate-holo {
            background-size: 200% 200%;
            animation: gradient-xy 3s ease infinite;
        }

        /* Text Glows */
        .text-glow-cyan {
            text-shadow: 0 0 5px rgba(6, 182, 212, 0.5), 0 0 10px rgba(6, 182, 212, 0.3);
        }
        .text-glow-purple {
            text-shadow: 0 0 5px rgba(168, 85, 247, 0.5), 0 0 10px rgba(168, 85, 247, 0.3);
        }

        /* Tech Borders */
        .tech-border {
            position: relative;
            background: rgba(15, 23, 42, 0.6); /* Slate 900 / 60% */
            border: 1px solid rgba(6, 182, 212, 0.3); /* Cyan 500 / 30% */
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .tech-input {
            background: rgba(30, 41, 59, 0.5); /* Slate 800 / 50% */
            border: 1px solid #334155;
            color: #ecfeff;
            transition: all 0.3s ease;
        }
        .tech-input:focus {
            border-color: #06b6d4;
            box-shadow: 0 0 8px rgba(6, 182, 212, 0.4);
            background: rgba(30, 41, 59, 0.8);
        }

        .orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        .mono {
            font-family: 'Share Tech Mono', monospace;
        }
    </style>
</head>
<body class="selection:bg-cyan-500 selection:text-white">
    <!-- Background Elements -->
    <div class="cyber-grid"></div>
    <div class="vignette"></div>
    
    <div id="root"></div>

    <!-- React Application Script -->
    <script type="text/babel" data-type="module">
        // FIX: Explicitly defined dependencies to ensure a singleton React instance
        import React, { useState, useEffect } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import { motion, AnimatePresence } from 'https://esm.sh/framer-motion@10.16.4?deps=react@18.2.0,react-dom@18.2.0';
        import { 
            BookOpen, 
            Gamepad2, 
            HeartHandshake, 
            MessageCircle, 
            FlaskConical, 
            ChevronRight, 
            ChevronLeft, 
            Copy, 
            CheckCircle, 
            Wand2, 
            Settings2, 
            UserCircle, 
            Sparkles, 
            Save, 
            RotateCcw,
            Plus,
            Trash2,
            Monitor,
            Bot,
            Cpu, // Added CPU icon for extra tech feel
            Zap,  // Added Zap icon
            Accessibility, // Added Accessibility icon
            ExternalLink // Added ExternalLink icon
        } from 'https://esm.sh/lucide-react@0.292.0?deps=react@18.2.0';

        // --- Components ---

        const Card = ({ children, className = "" }) => (
            <div className={`rounded-2xl overflow-hidden tech-border ${className}`}>
                {children}
            </div>
        );

        const Label = ({ children }) => (
            <label className="block text-sm font-bold text-cyan-300 mb-2 tracking-wide uppercase orbitron flex items-center gap-2">
                <span className="w-1 h-4 bg-cyan-500 rounded-sm inline-block"></span>
                {children}
            </label>
        );

        const Input = (props) => (
            <input 
                className={`w-full px-4 py-3 rounded-xl outline-none tech-input ${props.className || ""}`}
                {...props} 
            />
        );

        const TextArea = (props) => (
            <textarea 
                className={`w-full px-4 py-3 rounded-xl outline-none tech-input min-h-[120px] ${props.className || ""}`}
                {...props} 
            />
        );

        const Select = ({ options, value, onChange, className = "" }) => (
            <div className={`relative ${className}`}>
                <select 
                    value={value}
                    onChange={onChange}
                    className="w-full px-4 py-3 rounded-xl outline-none tech-input appearance-none cursor-pointer"
                >
                    {options.map(opt => (
                        <option key={opt.value} value={opt.value} className="bg-slate-900 text-slate-200">{opt.label}</option>
                    ))}
                </select>
                <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-cyan-500">
                    <ChevronRight size={16} className="rotate-90" />
                </div>
            </div>
        );

        // --- Main Application ---

        function App() {
            const [step, setStep] = useState(1);
            const [copied, setCopied] = useState(false);
            
            // Form State
            const [formData, setFormData] = useState({
                toolName: "",
                category: "æ•™å­¸éŠæˆ²", // Default
                subjectCategory: "èªæ–‡", // Subject Category
                subjectCustomInput: "", // Custom Subject Input
                gameStyle: ["æ‰­è›‹æ©Ÿ (Gachapon)"], // Changed to Array for Multi-select
                gameStyleCustomInput: "", // Custom Game Style Input
                interactionType: ["3é¸1ç­”æ¡ˆ"], // Array for Multi-select
                interactionCustomInput: "", // Custom Interaction Input
                learningDiversity: [], // New: Learning Diversity Support
                examples: [
                    { text: "", level: "åˆéš" },
                    { text: "", level: "ä¸­éš" },
                    { text: "", level: "é«˜éš" } // Added High level default
                ],
                grade: "å°å­¸äºŒå¹´ç´š (P2)",
                senLevel: "è¼•åº¦ (Mild)",
                purpose: "",
                context: "",
                value: ["å …æ¯…"], // Changed to Array for Multi-select
                rules: [`è¨ˆåˆ†è¦å‰‡ï¼šåŠªåŠ›çå‹µå‹è¨ˆåˆ†è¦å‰‡ï¼š
æ¯ç­”å° 1 é¡Œå¾— 10 åˆ†ï¼ˆè‚¯å®šå­¸ç¿’æˆæœï¼‰ï¼Œ
æ¯ç­”éŒ¯ 1 æ¬¡é¡å¤–åŠ  1 åˆ†ï¼ˆè‚¯å®šå‹‡æ–¼å˜—è©¦ï¼‰ã€‚
ç¸½åˆ†ï¼ç­”å°å¾—åˆ†ï¼‹éŒ¯èª¤æ¬¡æ•¸ï¼Œ
è®“ã€Œå …æŒåˆ°åº•ã€çš„åŠªåŠ›ä¹Ÿè¢«çœ‹è¦‹ï¼
èˆ‰ä¾‹ï¼š2 é¡Œå…¨å°ï¼Œä½†å…±éŒ¯ 6 æ¬¡ â†’ å¾—åˆ†ï¼20ï¼‹6ï¼26 åˆ†ã€‚å­¸ç”Ÿçš„å ±å‘Šçœ‹åˆ°ï¼š
ğŸ‰ æ­å–œä½ å…¨éƒ¨ç­”å°ï¼
èƒ½åŠ›å¾—åˆ†ï¼š20 åˆ†
åŠªåŠ›å˜—è©¦ï¼š6 æ¬¡
ç¸½æˆå°±åˆ†ï¼š26 åˆ†`, ""]
            });

            // Options
            const categories = [
                { value: "æ•™å­¸å·¥å…·", label: "ğŸ“š æ•™å­¸å·¥å…·", icon: BookOpen },
                { value: "æ•™å­¸éŠæˆ²", label: "ğŸ® æ•™å­¸éŠæˆ²", icon: Gamepad2 },
                { value: "æƒ…ç·’æ”¯æ´", label: "â¤ï¸ æƒ…ç·’æ”¯æ´", icon: HeartHandshake },
                { value: "æºé€šè¼”åŠ©", label: "ğŸ—£ï¸ æºé€šè¼”åŠ©", icon: MessageCircle },
                { value: "å¯¦é©—æ¨¡æ“¬", label: "ğŸ§ª å¯¦é©—æ¨¡æ“¬", icon: FlaskConical },
            ];

            const subjects = ["èªæ–‡", "æ•¸å­¸", "è‹±æ–‡", "äººæ–‡", "ç§‘å­¸", "ç”Ÿæ´»æŠ€èƒ½", "é›»è…¦", "ç­ä¸»ä»»èª²", "å…¶ä»–"];

            const gameStyles = [
                "æ‰­è›‹æ©Ÿ (Gachapon)", 
                "å¤¾å…¬ä»”æ©Ÿ (Claw Crane)", 
                "è€è™æ©Ÿ (Slot Machine)", 
                "è½‰ç›¤æŠ½ç (Spin Wheel)", 
                "å¤§å¯Œç¿ / éª°å­å‰é€² (Board Game)", 
                "å¯¶ç®± / ç¥ç§˜ç¦®ç›’ (Mystery Box)", 
                "æ°£çƒæˆ³ç ´ (Pop the Balloon)", 
                "æŠ•å¹£è¨±é¡˜æ±  (Wishing Well)", 
                "æ‰“åœ°é¼  (Whack-a-Mole)", 
                "æ¥æ°´æœ (Catching Fruit)", 
                "ç¦®ç‰©ç›’ / è–èª•æ‹†ç¦® (Gift Box)", 
                "é£²æ–™æ©Ÿ / è‡ªåŠ©é»é¤æ©Ÿ (Vending Machine)", 
                "æ”¾å¤©ç‡ˆ / å­”æ˜ç‡ˆ (Sky Lantern)", 
                "ç¥ˆç¦ç‰† / é¡˜æœ›æ¿ (Wish Wall)", 
                "é¦™çˆ / é»é¦™ç¥ˆç¦ (Incense Offering)", 
                "å…¶ä»–"
            ];
            
            const interactionTypes = [
                // åŸºç¤é¡Œå‹
                "3é¸1ç­”æ¡ˆ", 
                "4é¸1ç­”æ¡ˆ", 
                "å¤šé¸é¡Œ", 
                "è¼¸å…¥æ–‡å­— (Text Input)",
                "æ‰¾è©éŠæˆ² (Word Search Puzzle)", // Added Word Search Puzzle
                
                // æ“ä½œèˆ‡æ’åº
                "é»æ“Š (Click)",
                "æ‹–æ‹‰ç‰©ä»¶ (Drag & Drop)",
                "æ‹–æ‹‰æ’åº (Drag & Drop Ordering)",
                "é€£ç·šé¡Œ (Connect the Dots)",
                "åœ–è©é…å° (Matching)",
                "ç¿»å¡ / ç¿»ç‰Œè¨˜æ†¶é…å° (Memory Flip Cards)",
                "æ»‘æ¡¿èª¿ç¯€ / æ•¸å€¼æ§åˆ¶ (Slider Control)",
                "æ—‹è½‰ / æ”¾å¤§ç‰©ä»¶",
                
                // å‰µä½œèˆ‡è—è¡“
                "ç•«å¸ƒç¹ªåœ– / è‡ªç”±å‰µä½œ (Drawing Canvas)",
                "å¡«è‰² / ä¸Šè‰² (Coloring)",
                "æ‹¼åœ– / æ‹¼åˆç¢ç‰‡ (Jigsaw Puzzle)",
                "è§’è‰²æ›è£ / æ–‡åŒ–æœé£¾è©¦ç©¿ (Virtual Dress-Up)",
                
                // æ¨¡æ“¬èˆ‡æ¢ç´¢
                "ç‰©ç†æ¨¡æ“¬ (Physics Simulation)",
                "æ¨¡æ“¬æ“ä½œ (Simulation Control)",
                "åœ°åœ–æ¢ç´¢ / é»æ“Šæ¢ç´¢ (Map Exploration)",
                "éš±è—ç‰©ä»¶å°‹æ‰¾ (Hidden Object Game)",
                "è§’è‰²è£å‚™ / å‡ç´šç³»çµ± (Inventory / Upgrade)",
                
                // æ•˜äº‹èˆ‡æƒ…å¢ƒ
                "è§’è‰²æ‰®æ¼” / å°è©±é¸æ“‡ (Branching Dialogue)",
                "æƒ…å¢ƒé¸æ“‡ â†’ å¾Œæœåé¥‹ (Moral Dilemma)",
                "è§’è‰²å°è©±è¼ªæµæœ—è®€ (Read-Aloud)",
                "æ•…äº‹æ¥é¾ / å…±å‰µæ–‡æœ¬ (Collaborative Story)",
                
                // å¤šæ„Ÿå®˜èˆ‡å…¶ä»–
                "æ‰‹å‹¢æ§åˆ¶ / æ„Ÿæ‡‰å™¨äº’å‹•",
                "éŸ³é »è¾¨è­˜ / éŒ„éŸ³äº’å‹•",
                "ç¤¾äº¤äº’å‹• / åˆ†äº«æˆå°±",
                "æ™‚é–“é™åˆ¶æŒ‘æˆ°",
                "å…¶ä»–"
            ];

            const learningDiversityOptions = [
                { label: "ç°¡åŒ–å…§å®¹ (Simplify Content)", desc: "ä½¿ç”¨ç°¡å–®è©å½™ã€çŸ­å¥ï¼Œé¿å…å†—é•·èªªæ˜ï¼›ä¸€æ¬¡åªæ•™ä¸€å€‹æ¦‚å¿µã€‚" },
                { label: "å¤šæ„Ÿå®˜è¼¸å…¥ (Multi-sensory)", desc: "çµåˆåœ–ç‰‡ã€è²éŸ³ã€å‹•ä½œã€è§¸è¦ºç­‰å¤šç®¡é“åˆºæ¿€ï¼Œæå‡ç†è§£èˆ‡è¨˜æ†¶ã€‚" },
                { label: "çµæ§‹åŒ–èˆ‡é‡è¤‡ (Structure & Repetition)", desc: "æä¾›æ¸…æ™°æ­¥é©Ÿã€å›ºå®šæµç¨‹èˆ‡åè¦†ç·´ç¿’æ©Ÿæœƒã€‚" },
                { label: "å³æ™‚å›é¥‹èˆ‡çå‹µ (Instant Feedback)", desc: "æ¯å®Œæˆä¸€æ­¥å³çµ¦äºˆè‚¯å®šï¼ˆè²éŸ³ã€å‹•ç•«ã€è²¼ç´™ç­‰ï¼‰ï¼Œå¢å¼·å‹•æ©Ÿã€‚" },
                { label: "è¦–è¦ºè¼”åŠ© (Visual Aids)", desc: "ä½¿ç”¨åœ–å¡ã€æµç¨‹åœ–ã€é¡è‰²å€åˆ†ã€å¤§å­—é«”ã€é«˜å°æ¯”ç•Œé¢ã€‚" },
                { label: "ç”Ÿæ´»åŒ–å…§å®¹ (Real-life Context)", desc: "æ•™å­¸é€£çµæ—¥å¸¸ç”Ÿæ´»ï¼ˆå¦‚è³¼ç‰©ã€äº¤é€šã€è¡›ç”Ÿï¼‰ï¼Œæå‡å¯¦ç”¨æ€§ã€‚" },
                { label: "èªéŸ³æœ—è®€é¡Œç›® (TTS Question - HK)", desc: "é¡Œç›®æä¾›å»£æ±è©±èªéŸ³æœ—è®€åŠŸèƒ½ã€‚" },
                { label: "èªéŸ³æœ—è®€ç­”æ¡ˆ (TTS Answer - HK)", desc: "ç­”æ¡ˆæä¾›å»£æ±è©±èªéŸ³æœ—è®€åŠŸèƒ½ã€‚" },
                { label: "è¦–è¦ºæç¤º (Visual Cues)", desc: "åŠ å…¥ç®­é ­ã€è‰²å¡Šã€é€²åº¦æ¢ç­‰è¦–è¦ºæç¤ºã€‚" }
            ];

            const values = [
                "å …æ¯…", "å°Šé‡ä»–äºº", "è²¬ä»»æ„Ÿ", "åœ‹æ°‘èº«ä»½èªåŒ", "æ‰¿æ“”ç²¾ç¥", 
                "èª ä¿¡", "ä»æ„›", "å®ˆæ³•", "åŒç†å¿ƒ", "å‹¤å‹", "åœ˜çµ", "å­è¦ª"
            ];

            const grades = [
                "å°å­¸ä¸€å¹´ç´š (P1)", 
                "å°å­¸äºŒå¹´ç´š (P2)", 
                "å°å­¸ä¸‰å¹´ç´š (P3)", 
                "å°å­¸å››å¹´ç´š (P4)", 
                "å°å­¸äº”å¹´ç´š (P5)", 
                "å°å­¸å…­å¹´ç´š (P6)", 
                "ä¸­å­¸ä¸€å¹´ç´š (S1)", 
                "ä¸­å­¸äºŒå¹´ç´š (S2)", 
                "ä¸­å­¸ä¸‰å¹´ç´š (S3)", 
                "ä¸­å­¸å››å¹´ç´š (S4)", 
                "ä¸­å­¸äº”å¹´ç´š (S5)", 
                "ä¸­å­¸å…­å¹´ç´š (S6)"
            ];

            const difficultyLevels = [
                { value: "åˆéš", label: "åˆéš" },
                { value: "ä¸­éš", label: "ä¸­éš" },
                { value: "é«˜éš", label: "é«˜éš" }
            ];

            // Logic to handle Rule changes
            const handleRuleChange = (index, value) => {
                const newRules = [...formData.rules];
                newRules[index] = value;
                setFormData({ ...formData, rules: newRules });
            };

            const addRule = () => {
                setFormData({ ...formData, rules: [...formData.rules, ""] });
            };

            const removeRule = (index) => {
                const newRules = formData.rules.filter((_, i) => i !== index);
                setFormData({ ...formData, rules: newRules });
            };

            // Logic to handle Example changes
            const handleExampleChange = (index, field, value) => {
                const newExamples = [...formData.examples];
                newExamples[index] = { ...newExamples[index], [field]: value };
                setFormData({ ...formData, examples: newExamples });
            };

            const addExample = () => {
                setFormData({ ...formData, examples: [...formData.examples, { text: "", level: "åˆéš" }] });
            };

            const removeExample = (index) => {
                const newExamples = formData.examples.filter((_, i) => i !== index);
                setFormData({ ...formData, examples: newExamples });
            };

            // Generic Helper to toggle array selections
            const toggleSelection = (field, item) => {
                setFormData(prev => {
                    const current = prev[field];
                    if (current.includes(item)) {
                        return { ...prev, [field]: current.filter(t => t !== item) };
                    } else {
                        return { ...prev, [field]: [...current, item] };
                    }
                });
            };

            // Generate the Master Prompt
            const generatePrompt = () => {
                const rulesList = formData.rules.filter(r => r.trim() !== "").map((r, i) => `${i + 1}. ${r}`).join("\n    ");
                const examplesList = formData.examples.filter(ex => ex.text.trim() !== "").map((ex, i) => `* [${ex.level}] ${ex.text}`).join("\n    ");
                const isGame = formData.category === "æ•™å­¸éŠæˆ²";
                
                // Determine the subject display string
                const subject = formData.subjectCategory === "å…¶ä»–" ? formData.subjectCustomInput : formData.subjectCategory;

                // Determine game style display string (Multi-select)
                let styles = [...formData.gameStyle];
                if (styles.includes("å…¶ä»–")) {
                    styles = styles.filter(s => s !== "å…¶ä»–");
                    if (formData.gameStyleCustomInput.trim()) {
                        styles.push(formData.gameStyleCustomInput);
                    }
                }
                const style = styles.length > 0 ? styles.join("ã€") : "æœªæŒ‡å®š";
                
                // Determine the interaction display string (Multi-select)
                let interactions = [...formData.interactionType];
                if (interactions.includes("å…¶ä»–")) {
                    interactions = interactions.filter(i => i !== "å…¶ä»–");
                    if (formData.interactionCustomInput.trim()) {
                        interactions.push(formData.interactionCustomInput);
                    }
                }
                const interaction = interactions.length > 0 ? interactions.join("ã€") : "æœªæŒ‡å®š";

                // Determine Learning Diversity string
                const diversityList = formData.learningDiversity.map(opt => {
                    const option = learningDiversityOptions.find(o => o.label === opt);
                    return `* **${opt}**ï¼š${option ? option.desc : ""}`;
                }).join("\n    ");

                // Determine Values string (Multi-select)
                const valuesStr = formData.value.length > 0 ? formData.value.join("ã€") : "ç„¡";
                
                let prompt = `# 1. è§’è‰²è¨­å®š (Role)
ä½ æ˜¯ä¸€ä½æ“æœ‰ 15 å¹´ç¶“é©—çš„ã€Œè³‡æ·±å‰ç«¯å·¥ç¨‹å¸«ã€èˆ‡ã€Œæ•™è‚²ç§‘æŠ€ (EdTech) UX å°ˆå®¶ã€ã€‚ä½ æ“…é•·è£½ä½œä»‹é¢ç›´è§€ã€äº’å‹•æ€§é«˜ä¸”ç¬¦åˆç„¡éšœç¤™è¨­è¨ˆçš„ç¶²é æ‡‰ç”¨ç¨‹å¼ã€‚

# 2. å°ˆæ¡ˆåƒæ•¸é…ç½® (Configuration)
**è«‹æ ¹æ“šä»¥ä¸‹è¨­å®šï¼Œæ§‹å»ºç¨‹å¼çš„é‚è¼¯èˆ‡å…§å®¹ï¼š**

* **å·¥å…·åç¨±**ï¼š${formData.toolName || "[æœªå‘½åå·¥å…·]"}
* **å·¥å…·ç¯„ç–‡**ï¼š${formData.category}
* **ç§‘ç›®**ï¼š${subject || "æœªæŒ‡å®š"}
${isGame ? `* **éŠæˆ²é¢¨æ ¼ (Game Style)**ï¼š${style} (è«‹ä»¥æ­¤é¢¨æ ¼ä½œç‚ºä¸»è¦çš„è¦–è¦ºéš±å–»èˆ‡äº’å‹•åŒ…è£)` : ""}
* **äº’å‹•æ©Ÿåˆ¶**ï¼š${interaction}
${isGame ? `* **éŠæˆ²æ¨¡å¼éœ€æ±‚**ï¼šè«‹ç”Ÿæˆ **ä¸‰ç¨®éŠæˆ²æ¨¡å¼**ï¼Œæ¯ç¨®æ¨¡å¼éœ€åˆ†é–‹ **åˆéšã€ä¸­éšã€é«˜éš** ä¸‰ç¨®é›£åº¦ã€‚` : ""}
${isGame && examplesList ? `* **ç¯„ä¾‹é¡Œç›® (Example Questions)**ï¼š\n    ${examplesList}` : ""}
* **æ ¸å¿ƒç”¨é€”**ï¼š${formData.purpose || "å°šæœªå¡«å¯«ç”¨é€”"}
* **ç›®æ¨™å­¸ç”Ÿå¹´ç´š**ï¼š${formData.grade}
* **æ”¯æ´éœ€æ±‚ (SEN Support)**ï¼š${formData.senLevel}
    * *é‚è¼¯è¨­å®šï¼šã€Œä¸­åº¦ã€éœ€æ›´å¤šè¦–è¦ºè¼”åŠ©ã€å°‘å­—å¤šåœ–ã€è©å½™ç°¡å–®ï¼›ã€Œè¼•åº¦ã€å¯åŒ…å«è¼ƒå¤šæ–‡å­—èªªæ˜ã€‚*
* **ç…§é¡§å­¸ç¿’å·®ç•° (Learning Diversity Support)**ï¼š
    ${diversityList || "ç„¡ç‰¹æ®Šè¨­å®š"}
* **ç”Ÿæ´»æƒ…å¢ƒè¨­å®š**ï¼š${formData.context || "ä¸€èˆ¬æ•™å®¤æƒ…å¢ƒ"}
* **èå…¥åƒ¹å€¼è§€**ï¼š${valuesStr}
* **å…·é«”è¦å‰‡èˆ‡é‚è¼¯**ï¼š
    ${rulesList || "ç„¡ç‰¹æ®Šè¦å‰‡"}

# 3. è¨­è¨ˆèˆ‡æ•™è‚²åŸå‰‡ (Design & Pedagogical Principles)
**è«‹åš´æ ¼éµå®ˆä»¥ä¸‹ 5 å¤§åŸå‰‡ï¼š**

1.  **ğŸŒˆ è¦–è¦ºå‹å–„ (Visual Friendliness)**
    * **é¢¨æ ¼**ï¼šå¯æ„›å¡é€šã€è‰²å½©æ˜äº®ã€å¤§å­—é«”ï¼ˆLarge Fontsï¼‰ã€‚
    * **æ’ç‰ˆ**ï¼šæ¡ç”¨ "Bento Grid" (ä¾¿ç•¶ç›’å¼ä½ˆå±€) æˆ– "Glassmorphism" (æ¯›ç»ç’ƒç‰¹æ•ˆ)ã€‚
    * **åŸå‰‡**ï¼šShow, don't tellï¼ˆç”¨å¤§åœ–ç¤ºèˆ‡æ¸…æ™°å‹•ç•«ä»£æ›¿å†—é•·èªªæ˜ï¼‰ã€‚
    * **RWD**ï¼šå¿…é ˆåŒæ™‚å®Œç¾æ”¯æ´é›»è…¦ï¼ˆæŠ•å½±ç”¨ï¼‰èˆ‡å¹³æ¿ï¼ˆiPad æ“ä½œç”¨ï¼‰ã€‚

2.  **ğŸ§  èªçŸ¥æ”¯æ´ (Cognitive Support)**
    * **å³æ™‚åé¥‹**ï¼šæ­£ç¢ºé¡¯ç¤º âœ… + æ„‰æ‚…éŸ³æ•ˆï¼›éŒ¯èª¤é¡¯ç¤º âŒ + æº«å’Œæç¤ºéŸ³ã€‚
    * **å®¹éŒ¯è¨­è¨ˆ**ï¼šå¿…é ˆæä¾›ã€Œæ’¤éŠ· (Undo)ã€æˆ–ã€Œé‡è©¦ã€æŒ‰éˆ•ã€‚
    * **æ­¥é©Ÿæ‹†è§£**ï¼šå°‡è¤‡é›œä»»å‹™åˆ†è§£ç‚ºæ¸…æ™°çš„å–®ä¸€æ­¥é©Ÿã€‚

3.  **ğŸŒ ç”Ÿæ´»é€£çµ (Real-life Context)**
    * æƒ…å¢ƒè¨­å®šéœ€è²¼è¿‘å­¸ç”Ÿç”Ÿæ´»ï¼ˆå¦‚ï¼š${formData.context || "æ—¥å¸¸ç”Ÿæ´»"}ï¼‰ã€‚
    * å„ªå…ˆé€£çµç¨ç«‹ç”Ÿæ´»æŠ€èƒ½ï¼ˆSocial & Life Skillsï¼‰ã€‚

4.  **â¤ï¸ æƒ…ç·’æ”¯æŒ (Emotional Support)**
    * **æˆé•·å‹æ€ç¶­**ï¼šéŒ¯èª¤æ™‚**çµ•ä¸è²¬å‚™**ï¼ˆé¡¯ç¤ºï¼šã€Œå†è©¦ä¸€æ¬¡ï¼ã€ã€ã€Œå·®ä¸€é»é»ï¼ã€ï¼‰ã€‚
    * **æ­£å‘å¢å¼·**ï¼šä»»å‹™å®Œæˆæ™‚ï¼Œçµ¦äºˆå¼·çƒˆè¦–è¦ºå›é¥‹ï¼ˆå¦‚æ˜Ÿæ˜Ÿé£›å‡ºã€æŒè²ï¼‰ã€‚

5.  **ğŸ›¡ï¸ å®‰å…¨èˆ‡åƒ¹å€¼è§€ (Safety & Values)**
    * **åƒ¹å€¼è§€æ»²é€**ï¼šåœ¨å›é¥‹æˆ–ä»‹é¢è§’è½è‡ªç„¶èå…¥ã€Œ${valuesStr}ã€çš„æ¦‚å¿µã€‚
`;

                if (isGame) {
                    prompt += `
# 4. æ™ºèƒ½æ•™å­¸é‚è¼¯ (AI Scaffolding Logic)
**ç¨‹å¼éœ€å…§å»ºä»¥ä¸‹ä¸‰éšå›æ‡‰æ©Ÿåˆ¶ï¼Œæ ¹æ“šå­¸ç”Ÿè¡¨ç¾å‹•æ…‹èª¿æ•´ï¼š**

* **ğŸŸ¢ åˆéš (Level 1: Visual)**ï¼šä¸€å¥è©±ç›´çƒç­”æ¡ˆ + æ ¸å¿ƒ Emoji/åœ–ç‰‡ã€‚ï¼ˆé©ç”¨ï¼šå‰›é–‹å§‹æˆ–ä¸­åº¦æ”¯æ´éœ€æ±‚ï¼‰
* **ğŸŸ¡ é€²éš (Level 2: Logic)**ï¼šç°¡çŸ­è§£é‡‹å› æœé—œä¿‚ï¼ˆå…©å¥è©±å…§ï¼‰ã€‚ï¼ˆé©ç”¨ï¼šå·²æŒæ¡åè©ï¼‰
* **ğŸ”´ é«˜éš (Level 3: Metacognition)**ï¼šè§£é‡‹ + å¼•å°åå•ï¼ˆä¾‹å¦‚ï¼šã€Œä½ å¯ä»¥å•æˆ‘...ã€ï¼‰ã€‚ï¼ˆé©ç”¨ï¼šè¡¨ç¾å„ªç•°è€…ï¼‰

# 5. éŠæˆ²åŒ–çµç®—ç³»çµ± (Game Over & Report)
ç•¶æ´»å‹•çµæŸæ™‚ï¼Œé¡¯ç¤ºã€Œå€‹åˆ¥åŒ–å ±å‘Šã€ç•«é¢ï¼š

1.  **è¡¨ç¾åˆ†æ**ï¼šé¡¯ç¤ºç¸½åˆ†ï¼ŒéŒ¯èª¤åˆ—è¡¨ï¼Œå¸¸çŠ¯éŒ¯èª¤ï¼Œå·²æŒæ¡çš„çŸ¥è­˜ï¼Œçµ¦äºˆä¸€äº›å»ºè­°ï¼ˆèªæ°£æº«å’Œï¼‰ã€‚
2.  **é©æ€§åŒ–å»ºè­° (Adaptive Recommendation)**ï¼š
    * *éŒ¯èª¤ç‡ > 40%*ï¼šå»ºè­°ã€Œå¤šç·´ç¿’åˆéšï¼ŒåŠ æ²¹ï¼Œä½ å¯ä»¥çš„ã€ã€‚
    * *éŒ¯èª¤ç‡ 10-40%*ï¼šå»ºè­°ã€Œåšå¾—å¾ˆå¥½ï¼Œç¹¼çºŒç©©å›ºçŸ¥è­˜ã€ã€‚
    * *éŒ¯èª¤ç‡ < 10%*ï¼šå»ºè­°ã€Œä½ æ˜¯å°ˆå®¶äº†ï¼æŒ‘æˆ°ä¸‹ä¸€éšå§ï¼ã€ã€‚
3.  **å°èˆª**ï¼šå¿…é ˆåŒ…å«ã€Œé‡ç©ã€èˆ‡ã€Œè¿”å›ä¸»é¸å–®ã€æŒ‰éˆ•ã€‚
`;
                }

                const nextSectionNum = isGame ? 6 : 4;

                prompt += `
# ${nextSectionNum}. æŠ€è¡“è¦æ ¼ (Technical Stack)
è«‹ç”Ÿæˆä¸€å€‹å®Œæ•´çš„ **React Component** æˆ– **å–®ä¸€ HTML æª”æ¡ˆ**ï¼Œä¸¦åŒ…å«ä»¥ä¸‹æŠ€è¡“å¯¦ä½œï¼š

1.  **Core Framework**: React (Functional Components + Hooks).
2.  **Styling**: Tailwind CSS (é…è‰²éœ€æ´»æ½‘ã€é«˜å°æ¯”ã€è­·çœ¼).
3.  **Icons**: Lucide-React.
4.  **Animation**: Framer Motion (æ‰€æœ‰é»æ“Šã€åˆ‡æ›ã€å¾—åˆ†ã€é€²å ´éƒ½å¿…é ˆæœ‰æµæš¢å‹•ç•«).
5.  **UI Library**: ä½¿ç”¨ shadcn/ui é¢¨æ ¼çš„çµ„ä»¶è¨­è¨ˆ.
6.  **å¿…å‚™åŠŸèƒ½**:
    * **ğŸ”Š èªéŸ³åŠŸèƒ½**: è‹¥å¯¦ä½œ \`speak\` å‡½å¼ï¼Œè«‹å°‡ \`lang\` é è¨­å€¼è¨­ç‚º \`'zh-HK'\`ã€‚
    * **ğŸ‰ æ…¶ç¥ç‰¹æ•ˆ**: ä»»å‹™å®Œæˆæ™‚è§¸ç™¼ canvas-confettiï¼ˆç‰¹æ•ˆåªæœƒè§¸ç™¼ä¸€æ¬¡ï¼Œé‡ç½®å¾Œæ‰æœƒå†æ¬¡è§¸ç™¼ï¼‰ã€‚
    * **â¬…ï¸ å°èˆª**: å·¦ä¸Šæ–¹å¿…é ˆæœ‰ä¸€å€‹é¡¯çœ¼çš„ã€Œè¿”å›ä¸»é ã€æŒ‰éˆ•ã€‚

# åŸ·è¡Œä»»å‹™ (Execution)
è«‹æ ¹æ“šä¸Šè¿°é…ç½®ï¼Œç·¨å¯«å®Œæ•´çš„ç¨‹å¼ç¢¼ã€‚ç¨‹å¼ç¢¼éœ€åŒ…å«å®Œæ•´çš„ UI ä½ˆå±€ã€é‚è¼¯è™•ç†${isGame ? "ã€ä»¥åŠä¸Šè¿°çš„ä¸‰éš AI å›æ‡‰å…§å®¹æ¨¡æ“¬" : ""}ã€‚`;

                return prompt;
            };

            const handleCopy = () => {
                const text = generatePrompt();
                const textArea = document.createElement("textarea");
                textArea.value = text;
                
                // Ensure it's not visible but part of the DOM
                textArea.style.position = "fixed";
                textArea.style.left = "-9999px";
                textArea.style.top = "0";
                
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                } catch (err) {
                    console.error('Unable to copy', err);
                }
                
                document.body.removeChild(textArea);
            };

            // --- Step Rendering ---

            const renderStep1 = () => (
                <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }} className="space-y-6">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="col-span-1 md:col-span-2">
                            <Label>1. å·¥å…·åç¨± (Tool Name)</Label>
                            <Input 
                                placeholder="ä¾‹å¦‚ï¼šå¿«æ¨‚è¾²å ´åŠ æ³•ç·´ç¿’ã€èª²å ‚æƒ…ç·’æº«åº¦è¨ˆ..." 
                                value={formData.toolName}
                                onChange={(e) => setFormData({...formData, toolName: e.target.value})}
                            />
                        </div>

                        <div>
                            <Label>2. å·¥å…·ç¯„ç–‡ (Category)</Label>
                            <div className="grid grid-cols-1 gap-3">
                                {categories.map((cat) => (
                                    <button
                                        key={cat.value}
                                        onClick={() => setFormData({...formData, category: cat.value})}
                                        className={`flex items-center p-3 rounded-xl border transition-all ${
                                            formData.category === cat.value 
                                                ? 'border-cyan-500 bg-cyan-900/30 text-cyan-200 ring-1 ring-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.3)]' 
                                                : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                        }`}
                                    >
                                        <cat.icon size={20} className="mr-3" />
                                        <span className="font-medium">{cat.label}</span>
                                    </button>
                                ))}
                            </div>
           
                            {/* Subject Selection - Moved to top level */}
                            <div className="mt-6">
                                <Label>3. ç§‘ç›® (Subject)</Label>
                                <Select 
                                    options={subjects.map(s => ({value: s, label: s}))}
                                    value={formData.subjectCategory}
                                    onChange={(e) => setFormData({...formData, subjectCategory: e.target.value})}
                                />
                                {formData.subjectCategory === "å…¶ä»–" && (
                                    <div className="mt-2">
                                        <Input
                                            placeholder="è«‹è¼¸å…¥ç§‘ç›®åç¨±..."
                                            value={formData.subjectCustomInput}
                                            onChange={(e) => setFormData({...formData, subjectCustomInput: e.target.value})}
                                            autoFocus
                                        />
                                    </div>
                                )}
                            </div>

                            {/* Game Style Selection - Only for "æ•™å­¸éŠæˆ²" */}
                            {formData.category === "æ•™å­¸éŠæˆ²" && (
                                <motion.div 
                                    initial={{ opacity: 0, height: 0 }} 
                                    animate={{ opacity: 1, height: "auto" }}
                                    className="mt-6 space-y-4"
                                >
                                    {/* Game Style */}
                                    <div>
                                        <Label>éŠæˆ²é¢¨æ ¼ (Game Style) <span className="text-xs text-cyan-500 ml-1 font-normal orbitron">[å¯å¤šé¸]</span></Label>
                                        <div className="grid grid-cols-2 gap-2">
                                            {gameStyles.map(style => (
                                                <button
                                                    key={style}
                                                    onClick={() => toggleSelection('gameStyle', style)}
                                                    className={`p-2 rounded-lg text-sm font-medium transition-all border text-left ${
                                                        formData.gameStyle.includes(style)
                                                            ? 'border-pink-500 bg-pink-900/30 text-pink-200 ring-1 ring-pink-500 shadow-[0_0_10px_rgba(236,72,153,0.3)]' 
                                                            : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                                    }`}
                                                >
                                                    {style}
                                                </button>
                                            ))}
                                        </div>
                                        {formData.gameStyle.includes("å…¶ä»–") && (
                                            <div className="mt-2">
                                                <Input
                                                    placeholder="è«‹è¼¸å…¥éŠæˆ²é¢¨æ ¼ (ä¾‹å¦‚ï¼šå°„æ“ŠéŠæˆ²ã€è¿·å®®)..."
                                                    value={formData.gameStyleCustomInput}
                                                    onChange={(e) => setFormData({...formData, gameStyleCustomInput: e.target.value})}
                                                    autoFocus
                                                />
                                            </div>
                                        )}
                                    </div>

                                    {/* Example Questions */}
                                    <div>
                                        <Label>ç¯„ä¾‹é¡Œç›® (Example Questions)</Label>
                                        <div className="space-y-3">
                                            {formData.examples.map((ex, index) => (
                                                <div key={index} className="flex gap-2 items-center">
                                                    <div className="flex-1">
                                                        <Input 
                                                            placeholder={`ä¾‹å¦‚ï¼šè˜‹æœæ˜¯ç”šéº¼é¡è‰²ï¼Ÿ`}
                                                            value={ex.text}
                                                            onChange={(e) => handleExampleChange(index, 'text', e.target.value)}
                                                        />
                                                    </div>
                                                    <div className="w-28">
                                                        <Select 
                                                            options={difficultyLevels}
                                                            value={ex.level}
                                                            onChange={(e) => handleExampleChange(index, 'level', e.target.value)}
                                                        />
                                                    </div>
                                                    <button 
                                                        onClick={() => removeExample(index)}
                                                        className="p-3 text-red-400 hover:text-red-300 hover:bg-red-900/30 border border-transparent hover:border-red-500/50 rounded-xl transition-colors"
                                                        disabled={formData.examples.length === 1}
                                                        title="ç§»é™¤ç¯„ä¾‹"
                                                    >
                                                        <Trash2 size={20} />
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                        <button 
                                            onClick={addExample}
                                            className="mt-3 text-sm font-bold text-cyan-400 hover:text-cyan-200 flex items-center px-4 py-2 rounded-lg hover:bg-cyan-900/30 border border-transparent hover:border-cyan-500/50 transition-all"
                                        >
                                            <Plus size={16} className="mr-1" /> æ–°å¢ç¯„ä¾‹
                                        </button>
                                    </div>

                                </motion.div>
                            )}
                        </div>

                        <div className="space-y-6">
                            <div>
                                <Label>4. ç›®æ¨™å¹´ç´š (Target Grade)</Label>
                                <Select 
                                    options={grades.map(g => ({value: g, label: g}))}
                                    value={formData.grade}
                                    onChange={(e) => setFormData({...formData, grade: e.target.value})}
                                />
                            </div>

                            <div>
                                <Label>5. æ”¯æ´éœ€æ±‚ (SEN Support)</Label>
                                <div className="grid grid-cols-1 gap-3">
                                    <button
                                        onClick={() => setFormData({...formData, senLevel: "è¼•åº¦ (Mild)"})}
                                        className={`p-4 rounded-xl border text-left transition-all ${
                                            formData.senLevel === "è¼•åº¦ (Mild)" 
                                                ? 'border-emerald-500 bg-emerald-900/30 text-emerald-200 ring-1 ring-emerald-500' 
                                                : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                        }`}
                                    >
                                        <div className="font-bold orbitron tracking-wide">è¼•åº¦éœ€æ±‚ (Mild)</div>
                                        <div className="text-xs opacity-70 mt-1">é©åˆä¸€èˆ¬ç†è§£åŠ›ï¼Œå¯åŒ…å«è¼ƒå¤šæ–‡å­—èªªæ˜èˆ‡å¼•å°ã€‚</div>
                                    </button>
                                    <button
                                        onClick={() => setFormData({...formData, senLevel: "ä¸­åº¦ (Moderate)"})}
                                        className={`p-4 rounded-xl border text-left transition-all ${
                                            formData.senLevel === "ä¸­åº¦ (Moderate)" 
                                                ? 'border-orange-500 bg-orange-900/30 text-orange-200 ring-1 ring-orange-500' 
                                                : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                        }`}
                                    >
                                        <div className="font-bold orbitron tracking-wide">ä¸­åº¦éœ€æ±‚ (Moderate)</div>
                                        <div className="text-xs opacity-70 mt-1">éœ€è¦é«˜å¼·åº¦è¦–è¦ºè¼”åŠ©ï¼Œå°‘å­—å¤šåœ–ï¼Œè©å½™ç°¡å–®ç›´æ¥ã€‚</div>
                                    </button>
                                </div>
                            </div>

                            {/* 6. Learning Diversity Support - New Section */}
                            <div>
                                <Label>6. ç…§é¡§å­¸ç¿’å·®ç•° (Learning Diversity) <span className="text-xs text-cyan-500 ml-1 font-normal orbitron">[å¯å¤šé¸]</span></Label>
                                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
                                    {learningDiversityOptions.map(opt => (
                                        <button
                                            key={opt.label}
                                            onClick={() => toggleSelection('learningDiversity', opt.label)}
                                            className={`p-3 rounded-lg text-sm font-medium transition-all border text-left flex flex-col gap-1 h-full ${
                                                formData.learningDiversity.includes(opt.label)
                                                ? 'border-cyan-500 bg-cyan-900/30 text-cyan-200 ring-1 ring-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.3)]'
                                                : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                            }`}
                                        >
                                            <span className="font-bold">{opt.label}</span>
                                            <span className="text-xs opacity-70 font-light">{opt.desc}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* 7. Interaction Mechanism - Renumbered to 7 */}
                        <div className="col-span-1 md:col-span-2 pt-4 border-t border-slate-800/50">
                             <Label>7. äº’å‹•æ©Ÿåˆ¶ (Interaction) <span className="text-xs text-cyan-500 ml-1 font-normal orbitron">[å¯å¤šé¸]</span></Label>
                             <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2">
                               {interactionTypes.map(type => (
                                 <button
                                   key={type}
                                   onClick={() => toggleSelection('interactionType', type)}
                                   className={`p-2 rounded-lg text-sm font-medium transition-all border text-left ${
                                     formData.interactionType.includes(type)
                                     ? 'border-violet-500 bg-violet-900/30 text-violet-200 ring-1 ring-violet-500 shadow-[0_0_10px_rgba(139,92,246,0.3)]' 
                                     : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                   }`}
                                 >
                                   {type}
                                 </button>
                               ))}
                             </div>
                             {formData.interactionType.includes("å…¶ä»–") && (
                               <div className="mt-2">
                                 <Input
                                   placeholder="è«‹è¼¸å…¥äº’å‹•æ–¹å¼ (ä¾‹å¦‚ï¼šé€£é€£çœ‹ã€å¡«ç©º)..."
                                   value={formData.interactionCustomInput}
                                   onChange={(e) => setFormData({...formData, interactionCustomInput: e.target.value})}
                                   autoFocus
                                 />
                               </div>
                             )}
                        </div>
                    </div>
                </motion.div>
            );

            const renderStep2 = () => (
                <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }} className="space-y-6">
                    <div>
                        <Label>5. æ ¸å¿ƒç”¨é€” (Core Purpose)</Label>
                        <div className="text-xs text-slate-400 mb-2">è«‹ç°¡è¿°é€™å€‹å·¥å…·è¦è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ</div>
                        <TextArea 
                            placeholder="ä¾‹å¦‚ï¼šè®“å­¸ç”Ÿé€éæ‹–æ”¾è˜‹æœä¾†ç·´ç¿’ 10 ä»¥å…§çš„åŠ æ³•ï¼Œæˆ–æ˜¯å¹«åŠ©è‡ªé–‰ç—‡å­¸ç”ŸæŒ‡èªç•¶ä¸‹çš„æƒ…ç·’..." 
                            value={formData.purpose}
                            onChange={(e) => setFormData({...formData, purpose: e.target.value})}
                        />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <Label>6. ç”Ÿæ´»æƒ…å¢ƒè¨­å®š (Context)</Label>
                            <Input 
                                placeholder="ä¾‹å¦‚ï¼šè¶…ç´šå¸‚å ´è³¼ç‰©ã€æ­ä¹˜åœ°éµã€ç¨®æ¤èŠ±æœµ..." 
                                value={formData.context}
                                onChange={(e) => setFormData({...formData, context: e.target.value})}
                            />
                        </div>
                        <div>
                            <Label>7. èå…¥åƒ¹å€¼è§€ (Values) <span className="text-xs text-cyan-500 ml-1 font-normal orbitron">[å¯å¤šé¸]</span></Label>
                            <div className="grid grid-cols-2 gap-2 mt-2">
                                {values.map(val => (
                                    <button
                                        key={val}
                                        onClick={() => toggleSelection('value', val)}
                                        className={`p-2 rounded-lg text-sm font-medium transition-all border text-left ${
                                            formData.value.includes(val)
                                            ? 'border-yellow-500 bg-yellow-900/30 text-yellow-200 ring-1 ring-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.3)]' 
                                            : 'border-slate-700 bg-slate-800/50 hover:bg-slate-700/50 text-slate-400'
                                        }`}
                                    >
                                        {val}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                </motion.div>
            );

            const renderStep3 = () => (
                <motion.div initial={{ opacity: 0, x: 20 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -20 }} className="space-y-6">
                    <div>
                        <Label>8. å…·é«”è¦å‰‡èˆ‡é‚è¼¯ (Rules)</Label>
                        <div className="text-xs text-slate-400 mb-2">è«‹åˆ—å‡ºé€™å€‹å·¥å…·å¿…é ˆéµå®ˆçš„è¦å‰‡ï¼ˆä¾‹å¦‚ï¼šè¨ˆåˆ†æ–¹å¼ã€åŒ¯å…¥åŠŸèƒ½ç­‰ï¼‰ã€‚</div>
                        
                        <div className="space-y-3">
                            {formData.rules.map((rule, index) => (
                                <div key={index} className="flex gap-2">
                                    <div className="flex-none pt-3 text-cyan-500 font-bold text-sm w-6 orbitron">
                                        {index + 1}.
                                    </div>
                                    <TextArea 
                                        value={rule} 
                                        onChange={(e) => handleRuleChange(index, e.target.value)}
                                        placeholder={`è¦å‰‡ ${index + 1} (ä¾‹å¦‚ï¼šç­”éŒ¯æ™‚è¦æ’­æ”¾æç¤ºéŸ³)`}
                                        className="min-h-[80px]"
                                    />
                                    <button 
                                        onClick={() => removeRule(index)}
                                        className="flex-none p-3 text-red-400 hover:text-red-300 hover:bg-red-900/30 border border-transparent hover:border-red-500/50 rounded-xl transition-colors h-12 mt-1"
                                        disabled={formData.rules.length === 1}
                                    >
                                        âœ•
                                    </button>
                                </div>
                            ))}
                        </div>
                        
                        <button 
                            onClick={addRule}
                            className="mt-3 text-sm font-bold text-cyan-400 hover:text-cyan-200 flex items-center px-4 py-2 rounded-lg hover:bg-cyan-900/30 border border-transparent hover:border-cyan-500/50 transition-all"
                        >
                            + æ–°å¢ä¸€æ¢è¦å‰‡
                        </button>
                    </div>
                </motion.div>
            );

            const renderStep4 = () => (
                <motion.div initial={{ opacity: 0, scale: 0.95 }} animate={{ opacity: 1, scale: 1 }} className="space-y-4">
                    <div className="bg-slate-900/50 border border-cyan-500/30 p-6 rounded-2xl flex items-start gap-4 shadow-[0_0_20px_rgba(6,182,212,0.1)]">
                        <div className="p-3 bg-cyan-900/30 rounded-full shadow-sm text-cyan-400 border border-cyan-500/50">
                            <Sparkles size={24} />
                        </div>
                        <div>
                            <h3 className="text-lg font-bold text-cyan-100 orbitron tracking-wide">æè©å·²ç”Ÿæˆï¼</h3>
                            <p className="text-cyan-200/70 text-sm mt-1">
                                è«‹é»æ“Šä¸‹æ–¹æŒ‰éˆ•è¤‡è£½ï¼Œç„¶å¾Œè²¼çµ¦ AIã€‚
                            </p>
                        </div>
                    </div>

                    <div className="relative">
                        <textarea 
                            readOnly
                            value={generatePrompt()}
                            className="w-full h-80 bg-slate-950 text-cyan-300 font-mono text-xs p-6 rounded-2xl outline-none resize-none leading-relaxed border border-slate-800 shadow-inner"
                        />
                        <button 
                            onClick={handleCopy}
                            className="absolute top-4 right-4 bg-slate-800/80 hover:bg-slate-700/80 text-cyan-400 backdrop-blur-md px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-bold transition-all border border-cyan-500/30 hover:border-cyan-400 shadow-[0_0_10px_rgba(6,182,212,0.1)]"
                        >
                            {copied ? <CheckCircle size={16} className="text-green-400" /> : <Copy size={16} />}
                            {copied ? "å·²è¤‡è£½ï¼" : "è¤‡è£½å…§å®¹"}
                        </button>
                    </div>
                </motion.div>
            );

            return (
                <div className="min-h-screen p-4 md:p-8 relative z-10">
                    <div className="max-w-3xl mx-auto pb-20"> {/* pb-20 for footer spacing */}
                        
                        {/* Header */}
                        <header className="mb-8 text-center md:text-left flex flex-col md:flex-row md:items-start justify-between gap-4">
                            <div>
                                <h1 className="text-2xl md:text-3xl font-black flex items-start gap-3 justify-center md:justify-start">
                                    <span className="text-4xl filter drop-shadow-[0_0_10px_rgba(6,182,212,0.8)]">ğŸ¤–</span> {/* Robot Emoji */}
                                    <div className="flex flex-col">
                                        <span className="bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 via-blue-400 to-purple-400 drop-shadow-sm font-black tracking-wide text-glow-cyan text-xl md:text-2xl">
                                            æ•™å­¸è¨­è¨ˆè¼”åŠ©å·¥å…·æè©å™¨
                                        </span>
                                        <span className="font-['Orbitron'] bg-clip-text text-transparent bg-gradient-to-r from-purple-400 via-pink-400 to-red-400 drop-shadow-sm tracking-wider text-lg md:text-xl font-bold mt-1">
                                            Teaching Design Aids Prompt Builder
                                        </span>
                                        <span className="text-base md:text-lg text-cyan-500 font-bold font-['Orbitron'] tracking-[0.2em] mt-1 opacity-80">
                                            [ TDA Prompt Builder ]
                                        </span>
                                    </div>
                                </h1>
                                <p className="text-slate-400 mt-3 font-medium pl-0 md:pl-[3.5rem] flex items-center gap-2">
                                    <Zap size={16} className="text-yellow-400" />
                                    3 åˆ†é˜è¨­è¨ˆå°ˆå±¬æ•™æï¼šè¼¸å…¥éœ€æ±‚ï¼Œè‡ªå‹•ç”Ÿæˆå·¥ç¨‹å¸«ç´šçš„é–‹ç™¼æŒ‡ä»¤ã€‚
                                </p>
                            </div>
                            <div className="hidden md:block mt-2">
                                <div className="px-4 py-2 rounded-full border border-cyan-500/50 bg-cyan-950/30 text-sm font-bold text-cyan-400 flex items-center gap-2 shadow-[0_0_10px_rgba(6,182,212,0.2)] orbitron tracking-wider">
                                    <Bot size={16} />
                                    v1.0
                                </div>
                            </div>
                        </header>

                        {/* Progress Bar */}
                        <div className="mb-8">
                            <div className="flex justify-between text-xs font-bold text-slate-500 mb-2 uppercase tracking-wider orbitron">
                                <span className={step >= 1 ? "text-cyan-400 text-glow-cyan" : ""}>åŸºæœ¬è³‡æ–™</span>
                                <span className={step >= 2 ? "text-cyan-400 text-glow-cyan" : ""}>å…§å®¹æƒ…å¢ƒ</span>
                                <span className={step >= 3 ? "text-cyan-400 text-glow-cyan" : ""}>è¦å‰‡è¨­å®š</span>
                                <span className={step >= 4 ? "text-cyan-400 text-glow-cyan" : ""}>å®Œæˆç”Ÿæˆ</span>
                            </div>
                            <div className="h-2 bg-slate-800 rounded-full overflow-hidden border border-slate-700/50">
                                <motion.div 
                                    className="h-full bg-gradient-to-r from-cyan-500 via-blue-500 to-purple-500 shadow-[0_0_10px_rgba(6,182,212,0.5)]"
                                    initial={{ width: "0%" }}
                                    animate={{ width: `${(step / 4) * 100}%` }}
                                    transition={{ duration: 0.3 }}
                                />
                            </div>
                        </div>

                        {/* Wizard Card */}
                        <Card className="min-h-[500px] flex flex-col">
                            <div className="p-6 md:p-8 flex-1">
                                <AnimatePresence mode="wait">
                                    {step === 1 && renderStep1()}
                                    {step === 2 && renderStep2()}
                                    {step === 3 && renderStep3()}
                                    {step === 4 && renderStep4()}
                                </AnimatePresence>
                            </div>

                            {/* Footer Controls */}
                            <div className="bg-slate-900/50 border-t border-slate-800 p-6 flex justify-between items-center backdrop-blur-sm">
                                {step > 1 ? (
                                    <button 
                                        onClick={() => setStep(step - 1)}
                                        className="flex items-center gap-2 px-6 py-3 rounded-xl font-bold text-slate-400 hover:text-white hover:bg-slate-800 transition-all"
                                    >
                                        <ChevronLeft size={20} />
                                        ä¸Šä¸€æ­¥
                                    </button>
                                ) : (
                                    <div /> /* Spacer */
                                )}

                                {step < 4 ? (
                                    <button 
                                        onClick={() => setStep(step + 1)}
                                        className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white rounded-xl font-bold shadow-[0_0_20px_rgba(6,182,212,0.4)] transition-all hover:scale-105 active:scale-95 group"
                                    >
                                        ä¸‹ä¸€æ­¥
                                        <ChevronRight size={20} className="group-hover:translate-x-1 transition-transform" />
                                    </button>
                                ) : (
                                    <button 
                                        onClick={() => {
                                            setStep(1);
                                            setCopied(false);
                                        }}
                                        className="flex items-center gap-2 px-6 py-3 rounded-xl font-bold text-slate-400 hover:text-cyan-400 hover:bg-slate-800 transition-all"
                                    >
                                        <RotateCcw size={18} />
                                        é‡æ–°è¨­è¨ˆ
                                    </button>
                                )}
                            </div>
                        </Card>

                        {/* Extra Links Above Footer */}
                        <div className="mt-12 flex flex-wrap justify-center gap-4">
                            <a href="https://base44.com/" target="_blank" rel="noopener noreferrer" className="px-4 py-2 rounded-lg border border-cyan-500/30 bg-cyan-900/20 text-cyan-300 hover:bg-cyan-500/20 hover:text-cyan-100 transition-all text-sm font-medium flex items-center gap-2">
                                Base44 <ExternalLink size={14} />
                            </a>
                            <a href="https://app.emergent.sh/home" target="_blank" rel="noopener noreferrer" className="px-4 py-2 rounded-lg border border-purple-500/30 bg-purple-900/20 text-purple-300 hover:bg-purple-500/20 hover:text-purple-100 transition-all text-sm font-medium flex items-center gap-2">
                                Emergent <ExternalLink size={14} />
                            </a>
                            <a href="https://v0.app/" target="_blank" rel="noopener noreferrer" className="px-4 py-2 rounded-lg border border-slate-500/30 bg-slate-800/20 text-slate-300 hover:bg-slate-700/40 hover:text-slate-100 transition-all text-sm font-medium flex items-center gap-2">
                                v0.app <ExternalLink size={14} />
                            </a>
                            <a href="https://gemini.google.com/gem/brainstormer" target="_blank" rel="noopener noreferrer" className="px-4 py-2 rounded-lg border border-blue-500/30 bg-blue-900/20 text-blue-300 hover:bg-blue-500/20 hover:text-blue-100 transition-all text-sm font-medium flex items-center gap-2">
                                Gemini <ExternalLink size={14} />
                            </a>
                        </div>

                        {/* Footer */}
                        <footer className="mt-6 py-6 text-center text-slate-600 text-xs font-medium orbitron tracking-widest">
                            Â© 2025 Ken Cheng | Created with Gemini Script & Tailwind CSS
                        </footer>

                        {/* Floating Action Button (FAB) */}
                        <div className="fixed bottom-6 right-6 z-50">
                            <button className="flex items-center gap-2 px-4 py-2 rounded-full border border-white/20 backdrop-blur-md bg-gradient-to-r from-cyan-600/80 via-blue-600/80 to-purple-600/80 animate-holo text-white shadow-[0_0_15px_rgba(6,182,212,0.5)] hover:shadow-[0_0_25px_rgba(6,182,212,0.8)] transition-all hover:scale-105 group">
                                <Monitor size={20} className="group-hover:animate-pulse" />
                                <span className="font-bold text-sm tracking-wide text-shadow-sm">Ken Chengè¨­è¨ˆ</span>
                            </button>
                        </div>

                    </div>
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
